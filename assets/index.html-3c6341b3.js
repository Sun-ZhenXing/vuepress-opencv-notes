import{_ as r,r as D,o as y,c as d,b as s,d as n,a,w as l,e as c}from"./app-e045e1fd.js";const i={},C=s("h1",{id:"opencv-c-编译和构建指南",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#opencv-c-编译和构建指南","aria-hidden":"true"},"#"),n(" OpenCV C++ 编译和构建指南")],-1),E=s("h2",{id:"_1-基本编译指南",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-基本编译指南","aria-hidden":"true"},"#"),n(" 1. 基本编译指南")],-1),v={href:"https://github.com/opencv/opencv/releases",target:"_blank",rel:"noopener noreferrer"},_=s("code",null,"opencv-4.7.0.zip",-1),A={href:"https://github.com/opencv/opencv_contrib/tags",target:"_blank",rel:"noopener noreferrer"},u=s("code",null,"opencv_contrib-4.7.0.zip",-1),b=s("div",{class:"language-bash","data-ext":"sh"},[s("pre",{class:"shiki dark-plus",style:{"background-color":"#1E1E1E"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"curl"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-Lj"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-o"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"https://github.com/opencv/opencv/archive/refs/tags/4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"curl"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-Lj"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-o"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv_contrib-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"https://github.com/opencv/opencv_contrib/archive/refs/tags/4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"unzip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-d"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},".")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"unzip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv_contrib-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-d"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},".")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"cd"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"mkdir"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-p"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"build")]),n(`
`),s("span",{class:"line"})])])],-1),F=s("div",{class:"language-bash","data-ext":"sh"},[s("pre",{class:"shiki dark-plus",style:{"background-color":"#1E1E1E"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"curl"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-Lj"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-o"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"https://github.com/opencv/opencv/archive/refs/tags/4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"curl"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-Lj"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#569CD6"}},"-o"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv_contrib-4.7.0.zip"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"https://github.com/opencv/opencv_contrib/archive/refs/tags/4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"7z"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"x"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"7z"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"x"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv_contrib-4.7.0.zip")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"cd"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"opencv-4.7.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DCDCAA"}},"md"),s("span",{style:{color:"#D4D4D4"}}," "),s("span",{style:{color:"#CE9178"}},"build")]),n(`
`),s("span",{class:"line"})])])],-1),h=c(`<p>需要预先安装编译依赖，Windows 系统见下文。例如 Ubuntu 的基本依赖为：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">sudo</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">apt</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">install</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">build-essential</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">cmake</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">pkg-config</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libgtk-3-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">libavcodec-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libavformat-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libswscale-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libv4l-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">libxvidcore-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libx264-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libjpeg-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libpng-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libtiff-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">gfortran</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">openexr</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libatlas-base-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">python3-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">python3-numpy</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">libtbb2</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libtbb-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libdc1394-22-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libopenexr-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">libgstreamer-plugins-base1.0-dev</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">libgstreamer1.0-dev</span></span>
<span class="line"></span></code></pre></div><p>CMake 配置：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">mkdir</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">build</span></span>
<span class="line"><span style="color:#DCDCAA;">cmake</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">..</span></span>
<span class="line"></span></code></pre></div><p>编译和安装：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">make</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-j</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">$(</span><span style="color:#DCDCAA;">nproc</span><span style="color:#CE9178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DCDCAA;">sudo</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">make</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">install</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-构建-qt-支持" tabindex="-1"><a class="header-anchor" href="#_2-构建-qt-支持" aria-hidden="true">#</a> 2. 构建 Qt 支持</h2><p>如果需要编译基于 Qt 的图形界面，启用 <code>-D WITH_QT=ON</code> 来编译，例如：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">cmake</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">CMAKE_BUILD_TYPE=RELEASE</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">CMAKE_INSTALL_PREFIX=/usr/local/opencv470</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">INSTALL_C_EXAMPLE=OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">BUILD_EXAMPLE=OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">OPENCV_EXTRA_MODULES_PATH=../opencv_contrib-4.7.0/modules</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_V4L=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_TBB=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_VTK=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_GTK=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_OPENMP=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_OPENGL=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WITH_QT=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">BUILD_opencv_python3=OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">-D</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">BUILD_TIFF=ON</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">..</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-windows-编译指南" tabindex="-1"><a class="header-anchor" href="#_3-windows-编译指南" aria-hidden="true">#</a> 3. Windows 编译指南</h2><p>Windows 编译要求：</p><ul><li>Visual Studio 2019，并安装 C++ 桌面开发基本组件</li><li>CMake GUI 版本，也可以完全使用命令行</li></ul><p>在配置过程中将会自动下载依赖。</p><p>建议配置项：</p><ul><li>CUDA 支持，如果安装了 CUDA 可选择支持，不过需要选择你的显卡对应的算力</li><li><code>BUILD_opencv_world</code> 编译包含所有库的动态链接库</li><li>Test 选项可去除</li><li>Python/Java/JS 选项去除</li></ul><div class="hint-container info"><p class="hint-container-title">使用代理</p><p>使用大陆的网络可能无法下载依赖，需要使用代理。在 Environment 中增加 <code>http_proxy</code> 和 <code>https_proxy</code> 变量，并将其指定为一个可用的代理地址。例如：</p><div class="language-yaml" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">http_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://127.0.0.1:10809&#39;</span></span>
<span class="line"><span style="color:#569CD6;">https_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;socks5://127.0.0.1:10808&#39;</span></span>
<span class="line"></span></code></pre></div><p>在 Windows 上，Python 可能对 SOCKS 支持不完备，如果使用 SOCKS 协议时出现无法握手或者无法使用 DNS，将 <code>https_proxy</code> 代替为 <code>http_proxy</code> 的值即可：</p><div class="language-yaml" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">http_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://127.0.0.1:10809&#39;</span></span>
<span class="line"><span style="color:#569CD6;">https_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://127.0.0.1:10809&#39;</span></span>
<span class="line"></span></code></pre></div></div><details class="hint-container details"><summary>命令行编译指南</summary><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">cmake</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-G</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;Visual Studio 16 2019&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-T</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">host=x64</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-A</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">x64</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_DOCS</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_SHARED_LIBS</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_FAT_JAVA_LIB</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_TESTS</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_TIFF</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_JASPER</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_JPEG</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_PNG</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_ZLIB</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_OPENEXR</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_apps</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_calib3d</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_contrib</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_features2d</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_flann</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_gpu</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_java</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_legacy</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_ml</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_nonfree</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_objdetect</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_ocl</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_photo</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_python</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_stitching</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_superres</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_ts</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_video</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_videostab</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_world</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">ON</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_lengcy</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DBUILD_opencv_lengcy</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_1394</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_EIGEN</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_FFMPEG</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_GIGEAPI</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_GSTREAMER</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_GTK</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_PVAPI</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_V4L</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_LIBV4L</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_CUDA</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_CUFFT</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_OPENCL</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_OPENCLAMDBLAS</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">^</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">-DWITH_OPENCLAMDFFT</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">OFF</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">..</span></span>
<span class="line"><span style="color:#DCDCAA;">cmake</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--build</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">.</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--config</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">Release</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--target</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">ALL_BUILD</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-j</span><span style="color:#D4D4D4;"> </span><span style="color:#B5CEA8;">20</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="_4-opencv-cuda-编译指南" tabindex="-1"><a class="header-anchor" href="#_4-opencv-cuda-编译指南" aria-hidden="true">#</a> 4. OpenCV CUDA 编译指南</h2><p>下面进行一份完整的 CUDA 支持的 OpenCV 编译过程，以 Windows 和 OpenCV 4.7.0 为例。</p><p>下面我的机器配置，请根据条件选择合适的配置项目：</p><table><thead><tr><th>配置项</th><th>值</th></tr></thead><tbody><tr><td>CPU</td><td>Intel(R) Core(TM) i9-12900H</td></tr><tr><td>GPU</td><td>NVIDIA RTX 3070 Ti Laptop GPU</td></tr><tr><td>显存</td><td>8 GB</td></tr><tr><td>内存</td><td>16 GB</td></tr><tr><td>CUDA</td><td>12.1</td></tr><tr><td>VS</td><td>Visual Studio 2019 Community</td></tr></tbody></table><p>打开 CMake-GUI，然后选择源码和编译目录。</p><p>配置 Environment，设置 <code>http_proxy</code> 和 <code>https_proxy</code> 为代理地址。</p><div class="language-yaml" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">http_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://127.0.0.1:10809&#39;</span></span>
<span class="line"><span style="color:#569CD6;">https_proxy</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;http://127.0.0.1:10809&#39;</span></span>
<span class="line"></span></code></pre></div><p>点击 Configure，选择 Visual Studio 2019，然后点击 Finish。</p><p>第一次可选配置项：</p><table><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td><code>OPENCV_GENERATE_SETUPVARS</code></td><td><code>OFF</code></td><td>为了防止 <code>OpenCVGenSetupVars</code> 警告</td></tr><tr><td><code>BUILD_CUDA_STUBS</code></td><td><code>OFF</code></td><td>CUDA 桩库</td></tr><tr><td><code>WITH_CUDA</code></td><td><code>ON</code></td><td>CUDA</td></tr><tr><td><code>OPENCV_DNN_CUDA</code></td><td><code>ON</code></td><td>CUDA DNN</td></tr><tr><td><code>ENABLE_FAST_MATH</code></td><td><code>ON</code></td><td>快速数学库</td></tr><tr><td><code>BUILD_JAVA</code></td><td><code>OFF</code></td><td>Java 绑定</td></tr><tr><td><code>BUILD_opencv_java_bindings_generator</code></td><td><code>OFF</code></td><td>Java 绑定生成器</td></tr><tr><td><code>OPENCV_EXTRA_MODULES_PATH</code></td><td><code>D:/workspace/repo/opencv4.7/opencv_contrib-4.7.0/modules</code></td><td>额外模块路径，选择自己的下载位置</td></tr><tr><td><code>OPENCV_ENABLE_NONFREE</code></td><td><code>ON</code></td><td>非自由组件</td></tr><tr><td><code>BUILD_opencv_js</code></td><td><code>OFF</code></td><td>JS 绑定</td></tr><tr><td><code>BUILD_opencv_js_bindings_generator</code></td><td><code>OFF</code></td><td>JS 绑定生成器</td></tr><tr><td><code>BUILD_opencv_python3</code></td><td><code>OFF</code></td><td>Python3 绑定</td></tr><tr><td><code>BUILD_opencv_python_bindings_generator</code></td><td><code>OFF</code></td><td>Python3 绑定生成器</td></tr><tr><td><code>BUILD_opencv_python_tests</code></td><td><code>OFF</code></td><td>Python3 绑定测试</td></tr><tr><td><code>BUILD_opencv_objc_bindings_generator</code></td><td><code>OFF</code></td><td>Objective-C 绑定生成器</td></tr><tr><td><code>BUILD_opencv_world</code></td><td><code>ON</code></td><td>编译包含所有库的动态链接库</td></tr><tr><td><code>BUILD_SHARED_LIBS</code></td><td><code>ON</code></td><td>编译动态链接库，如果需要静态库请不要勾选</td></tr></tbody></table><p>如果需要 Python 绑定，则安装过程中将自动替换当前 Python 安装的 OpenCV，请谨慎选择。</p><p>根据需要选择即可，点击 Configure。</p>`,29),m={href:"https://developer.nvidia.com/cuda-gpus#compute",target:"_blank",rel:"noopener noreferrer"},O=s("strong",null,"CUDA-Enabled GeForce and TITAN Products",-1),I=c("<p>第二次可选配置项：</p><table><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td><code>CUDA_FAST_MATH</code></td><td><code>ON</code></td><td>快速数学库</td></tr><tr><td><code>CUDA_ARCH_BIN</code></td><td><code>7.5;8.6</code></td><td>显卡算力，此值兼容 20/30 系多数显卡</td></tr><tr><td><code>WITH_FREETYPE</code></td><td><code>OFF</code></td><td>FreeType 字体库</td></tr></tbody></table><p>点击 Configure，然后点击 Generate。此时将生成 Visual Studio 2019 的解决方案。</p><p>打开 <code>OpenCV.sln</code>，然后选择 Release 模式，右键资源管理器中的 <code>ALL_BUILD</code> 项目，然后选择生成。</p><p>此过程较长，请耐心等待，如果没有显示错误则生成成功。成功后右键 <code>INSTALL</code> 项目，然后选择生成。</p><p>生成目标默认安装在项目的 <code>install</code> 目录下，可以在 CMake-GUI 中修改。</p>",6);function L(B,U){const o=D("ExternalLinkIcon"),t=D("CodeTabs");return y(),d("div",null,[C,E,s("p",null,[n("下面都以 OpenCV 4.7.0 的编译为例。下载源代码 "),s("a",v,[_,a(o)]),n(" 和 "),s("a",A,[u,a(o)]),n("，解压到同一个文件夹。")]),a(t,{id:"9",data:[{id:"Linux"},{id:"Windows"}]},{title0:l(({value:p,isActive:e})=>[n("Linux")]),title1:l(({value:p,isActive:e})=>[n("Windows")]),tab0:l(({value:p,isActive:e})=>[b]),tab1:l(({value:p,isActive:e})=>[F]),_:1}),h,s("p",null,[n("查看显卡算力可以在 "),s("a",m,[n("NVIDIA 开发者官网"),a(o)]),n(" 的算力表，在 "),O,n(" 一栏可以看到 GeForce 系列的算力，例如 RTX 3070 Ti Laptop GPU 的算力为 8.6。")]),I])}const T=r(i,[["render",L],["__file","index.html.vue"]]);export{T as default};
