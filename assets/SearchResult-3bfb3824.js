import{u as K,a as x,W as V,H as J,b as N,n as X,o as Z,s as ee,l as te,i as le,c as ae,d as re,m as ne,e as oe,h as H}from"./app-87601b76.js";import{c as se,u as ue,ab as ie,r as m,h as O,o as ce,I as ve,j as a,a5 as q,z as de,K as fe,i as he}from"./framework-8980b429.js";function pe(l){if(Array.isArray(l)){for(var e=0,t=Array(l.length);e<l.length;e++)t[e]=l[e];return t}else return Array.from(l)}var P=!1;if(typeof window<"u"){var W={get passive(){P=!0}};window.addEventListener("testPassive",null,W),window.removeEventListener("testPassive",null,W)}var I=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),p=[],L=!1,D=-1,g=void 0,w=void 0,Y=function(e){return p.some(function(t){return!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))})},T=function(e){var t=e||window.event;return Y(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},ye=function(e){if(w===void 0){var t=!!e&&e.reserveScrollBarGap===!0,s=window.innerWidth-document.documentElement.clientWidth;t&&s>0&&(w=document.body.style.paddingRight,document.body.style.paddingRight=s+"px")}g===void 0&&(g=document.body.style.overflow,document.body.style.overflow="hidden")},me=function(){w!==void 0&&(document.body.style.paddingRight=w,w=void 0),g!==void 0&&(document.body.style.overflow=g,g=void 0)},ge=function(e){return e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1},we=function(e,t){var s=e.targetTouches[0].clientY-D;return Y(e.target)?!1:t&&t.scrollTop===0&&s>0||ge(t)&&s<0?T(e):(e.stopPropagation(),!0)},Se=function(e,t){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!p.some(function(o){return o.targetElement===e})){var s={targetElement:e,options:t||{}};p=[].concat(pe(p),[s]),I?(e.ontouchstart=function(o){o.targetTouches.length===1&&(D=o.targetTouches[0].clientY)},e.ontouchmove=function(o){o.targetTouches.length===1&&we(o,e)},L||(document.addEventListener("touchmove",T,P?{passive:!1}:void 0),L=!0)):ye(t)}},be=function(){I?(p.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),L&&(document.removeEventListener("touchmove",T,P?{passive:!1}:void 0),L=!1),D=-1):me(),p=[]};const Le="search-pro-history-results",v=K(Le,[]),Te=()=>{const{historyCount:l}=H;return{history:v,addHistory:e=>{v.value.length<l?v.value=[e,...v.value]:v.value=[e,...v.value.slice(0,l-1)]},removeHistory:e=>{v.value=[...v.value.slice(0,e),...v.value.slice(e+1)]}}},ke=l=>{const e=x(),t=m(!1),s=m([]);let o;const d=oe(f=>{t.value=!0,o==null||o.terminate(),f?(o=new Worker(`/vuepress-opencv-notes/${H.worker}`,{}),o.addEventListener("message",({data:S})=>{s.value=S,t.value=!1}),o.postMessage({query:f,routeLocale:e.value})):(s.value=[],t.value=!1)},H.delay);return de([l,e],()=>d(l.value),{immediate:!0}),{searching:t,results:s}};var Ae=se({name:"SearchResult",props:{query:{type:String,required:!0}},emits:{close:()=>!0,updateQuery:l=>!0},setup(l,{emit:e}){const t=re(),s=ue(),o=x(),d=V(J),{history:f,addHistory:S,removeHistory:U}=Te(),k=ie(l,"query"),{results:y,searching:j}=ke(k),i=m(0),u=m(0),B=m(),$=O(()=>y.value.length>0),R=O(()=>y.value[i.value]||null),Q=()=>{i.value=i.value>0?i.value-1:y.value.length-1,u.value=R.value.contents.length-1},_=()=>{i.value=i.value<y.value.length-1?i.value+1:0,u.value=0},z=()=>{u.value<R.value.contents.length-1?u.value=u.value+1:_()},F=()=>{u.value>0?u.value=u.value-1:Q()},E=r=>r.map(n=>he(n)?n:a(n[0],n[1])),C=r=>{if(r.type==="custom"){const n=ne[r.index]||"$content",[h,b=""]=fe(n)?n[o.value].split("$content"):n.split("$content");return E([h,...r.display,b])}return E(r.display)},A=()=>{i.value=0,u.value=0,e("updateQuery",""),e("close")};return ce(()=>{N("keydown",r=>{if($.value){if(r.key==="ArrowUp")F();else if(r.key==="ArrowDown")z();else if(r.key==="Enter"){const n=R.value.contents[u.value];t.value.path!==n.path&&(S(n),s.push(n.path),A())}}}),Se(B.value,{reserveScrollBarGap:!0})}),ve(()=>{be()}),()=>a("div",{class:["search-pro-result",{empty:k.value===""?f.value.length===0:!$.value}],ref:B},k.value===""?f.value.length?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},d.value.history),f.value.map((r,n)=>a(q,{to:r.path,class:["search-pro-result-item",{active:u.value===n}],onClick:()=>{A()}},()=>[a(X,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[r.type==="content"&&r.header?a("div",{class:"content-header"},r.header):null,a("div",C(r))]),a("button",{class:"search-pro-close-icon",onClick:h=>{h.preventDefault(),h.stopPropagation(),U(n)}},a(Z))]))])):d.value.emptyHistory:j.value?a(ee,{hint:d.value.searching}):$.value?a("ul",{class:"search-pro-result-list"},y.value.map(({title:r,contents:n},h)=>{const b=i.value===h;return a("li",{class:["search-pro-result-list-item",{active:b}]},[a("div",{class:"search-pro-result-title"},r||"Documentation"),n.map((c,G)=>{const M=b&&u.value===G;return a(q,{to:c.path,class:["search-pro-result-item",{active:M,"aria-selected":M}],onClick:()=>{S(c),A()}},()=>[c.type==="content"?null:a(c.type==="title"?te:c.type==="heading"?le:ae,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[c.type==="content"&&c.header?a("div",{class:"content-header"},c.header):null,a("div",C(c))])])})])})):d.value.emptyResult)}});export{Ae as default};
